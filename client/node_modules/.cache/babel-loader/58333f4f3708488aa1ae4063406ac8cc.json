{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { MessageDeleted as DefaultMessageDeleted } from './MessageDeleted';\nimport { MessageRepliesCountButton as DefaultMessageRepliesCountButton } from './MessageRepliesCountButton';\nimport { MessageTimestamp as DefaultTimestamp } from './MessageTimestamp';\nimport { useReactionClick } from './hooks';\nimport { PinIndicator as DefaultPinIndicator, ErrorIcon, ReactionIcon, ThreadIcon } from './icons';\nimport { QuotedMessage as DefaultQuotedMessage } from './QuotedMessage';\nimport { areMessageUIPropsEqual, MESSAGE_ACTIONS, showMessageActionsBox } from './utils';\nimport { Avatar as DefaultAvatar } from '../Avatar';\nimport { CUSTOM_MESSAGE_TYPE } from '../../constants/messageTypes';\nimport { MessageActions } from '../MessageActions';\nimport { EditMessageForm as DefaultEditMessageForm, MessageInput } from '../MessageInput';\nimport { ReactionSelector as DefaultReactionSelector, SimpleReactionsList as DefaultReactionsList } from '../Reactions';\nimport { useComponentContext } from '../../context/ComponentContext';\nimport { useMessageContext } from '../../context/MessageContext';\nimport { useTranslationContext } from '../../context/TranslationContext';\nimport { renderText as defaultRenderText, isOnlyEmojis } from '../../utils';\n\nvar MessageLivestreamWithContext = function (props) {\n  var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k;\n\n  var clearEditingState = props.clearEditingState,\n      editing = props.editing,\n      groupStyles = props.groupStyles,\n      handleAction = props.handleAction,\n      handleOpenThread = props.handleOpenThread,\n      handleRetry = props.handleRetry,\n      initialMessage = props.initialMessage,\n      isReactionEnabled = props.isReactionEnabled,\n      message = props.message,\n      messageWrapperRef = props.messageWrapperRef,\n      onMentionsClickMessage = props.onMentionsClickMessage,\n      onMentionsHoverMessage = props.onMentionsHoverMessage,\n      onReactionListClick = props.onReactionListClick,\n      onUserClick = props.onUserClick,\n      onUserHover = props.onUserHover,\n      reactionSelectorRef = props.reactionSelectorRef,\n      _l = props.renderText,\n      renderText = _l === void 0 ? defaultRenderText : _l,\n      showDetailedReactions = props.showDetailedReactions,\n      unsafeHTML = props.unsafeHTML;\n\n  var _m = useComponentContext('MessageLivestream'),\n      Attachment = _m.Attachment,\n      _o = _m.Avatar,\n      Avatar = _o === void 0 ? DefaultAvatar : _o,\n      _p = _m.EditMessageInput,\n      EditMessageInput = _p === void 0 ? DefaultEditMessageForm : _p,\n      _q = _m.MessageDeleted,\n      MessageDeleted = _q === void 0 ? DefaultMessageDeleted : _q,\n      _r = _m.MessageRepliesCountButton,\n      MessageRepliesCountButton = _r === void 0 ? DefaultMessageRepliesCountButton : _r,\n      _s = _m.PinIndicator,\n      PinIndicator = _s === void 0 ? DefaultPinIndicator : _s,\n      _t = _m.QuotedMessage,\n      QuotedMessage = _t === void 0 ? DefaultQuotedMessage : _t,\n      _u = _m.ReactionsList,\n      ReactionsList = _u === void 0 ? DefaultReactionsList : _u,\n      _v = _m.ReactionSelector,\n      ReactionSelector = _v === void 0 ? DefaultReactionSelector : _v;\n\n  var _w = useTranslationContext('MessageLivestream'),\n      t = _w.t,\n      userLanguage = _w.userLanguage;\n\n  var messageTextToRender = ((_a = message.i18n) === null || _a === void 0 ? void 0 : _a[userLanguage + \"_text\"]) || message.text;\n  var messageText = useMemo(function () {\n    return renderText(messageTextToRender, message.mentioned_users);\n  }, [message.mentioned_users, messageTextToRender]);\n  var firstGroupStyle = groupStyles ? groupStyles[0] : 'single';\n\n  if (message.customType === CUSTOM_MESSAGE_TYPE.date) {\n    return null;\n  }\n\n  if (message.deleted_at) {\n    return React.createElement(MessageDeleted, {\n      message: message\n    });\n  }\n\n  if (editing) {\n    return React.createElement(\"div\", {\n      className: \"str-chat__message-team str-chat__message-team--\" + firstGroupStyle + \" str-chat__message-team--editing\",\n      \"data-testid\": 'message-livestream-edit'\n    }, (firstGroupStyle === 'top' || firstGroupStyle === 'single') && React.createElement(\"div\", {\n      className: 'str-chat__message-team-meta'\n    }, React.createElement(Avatar, {\n      image: (_b = message.user) === null || _b === void 0 ? void 0 : _b.image,\n      name: ((_c = message.user) === null || _c === void 0 ? void 0 : _c.name) || ((_d = message.user) === null || _d === void 0 ? void 0 : _d.id),\n      onClick: onUserClick,\n      onMouseOver: onUserHover,\n      size: 40\n    })), React.createElement(MessageInput, {\n      clearEditingState: clearEditingState,\n      Input: EditMessageInput,\n      message: message\n    }));\n  }\n\n  return React.createElement(React.Fragment, null, message.pinned && React.createElement(\"div\", {\n    className: 'str-chat__message-livestream-pin-indicator'\n  }, React.createElement(PinIndicator, {\n    message: message,\n    t: t\n  })), React.createElement(\"div\", {\n    className: \"str-chat__message-livestream str-chat__message-livestream--\" + firstGroupStyle + \" str-chat__message-livestream--\" + message.type + \" str-chat__message-livestream--\" + message.status + \" \" + (initialMessage ? 'str-chat__message-livestream--initial-message' : '') + \" \" + (message.pinned ? 'pinned-message' : ''),\n    \"data-testid\": 'message-livestream',\n    ref: messageWrapperRef\n  }, showDetailedReactions && isReactionEnabled && React.createElement(ReactionSelector, {\n    ref: reactionSelectorRef\n  }), React.createElement(MessageLivestreamActions, {\n    messageWrapperRef: messageWrapperRef,\n    onReactionListClick: onReactionListClick\n  }), React.createElement(\"div\", {\n    className: 'str-chat__message-livestream-left'\n  }, React.createElement(Avatar, {\n    image: (_e = message.user) === null || _e === void 0 ? void 0 : _e.image,\n    name: ((_f = message.user) === null || _f === void 0 ? void 0 : _f.name) || ((_g = message.user) === null || _g === void 0 ? void 0 : _g.id),\n    onClick: onUserClick,\n    onMouseOver: onUserHover,\n    size: 30\n  })), React.createElement(\"div\", {\n    className: 'str-chat__message-livestream-right'\n  }, React.createElement(\"div\", {\n    className: 'str-chat__message-livestream-content'\n  }, React.createElement(\"div\", {\n    className: 'str-chat__message-livestream-author'\n  }, React.createElement(\"strong\", null, ((_h = message.user) === null || _h === void 0 ? void 0 : _h.name) || ((_j = message.user) === null || _j === void 0 ? void 0 : _j.id)), message.type === 'error' && React.createElement(\"div\", {\n    className: 'str-chat__message-team-error-header'\n  }, t('Only visible to you'))), React.createElement(\"div\", {\n    className: isOnlyEmojis(message.text) ? 'str-chat__message-livestream-text--is-emoji' : '',\n    \"data-testid\": 'message-livestream-text',\n    onClick: onMentionsClickMessage,\n    onMouseOver: onMentionsHoverMessage\n  }, message.quoted_message && React.createElement(\"div\", {\n    className: 'livestream-quoted-message'\n  }, React.createElement(QuotedMessage, null)), message.type !== 'error' && message.status !== 'failed' && !unsafeHTML && messageText, message.type !== 'error' && message.status !== 'failed' && unsafeHTML && !!message.html && React.createElement(\"div\", {\n    dangerouslySetInnerHTML: {\n      __html: message.html\n    }\n  }), message.type === 'error' && !message.command && React.createElement(\"p\", {\n    \"data-testid\": 'message-livestream-error'\n  }, React.createElement(ErrorIcon, null), message.text), message.type === 'error' && message.command && React.createElement(\"p\", {\n    \"data-testid\": 'message-livestream-command-error'\n  }, React.createElement(ErrorIcon, null), React.createElement(\"strong\", null, \"/\", message.command), \" is not a valid command\"), message.status === 'failed' && React.createElement(\"p\", {\n    onClick: message.errorStatusCode !== 403 ? function () {\n      return handleRetry(message);\n    } : undefined\n  }, React.createElement(ErrorIcon, null), message.errorStatusCode !== 403 ? t('Message Failed 路 Click to try again') : t('Message Failed 路 Unauthorized'))), ((_k = message.attachments) === null || _k === void 0 ? void 0 : _k.length) ? React.createElement(Attachment, {\n    actionHandler: handleAction,\n    attachments: message.attachments\n  }) : null, isReactionEnabled && React.createElement(ReactionsList, null), !initialMessage && React.createElement(MessageRepliesCountButton, {\n    onClick: handleOpenThread,\n    reply_count: message.reply_count\n  })))));\n};\n\nvar MessageLivestreamActions = function (props) {\n  var messageWrapperRef = props.messageWrapperRef,\n      onReactionListClick = props.onReactionListClick;\n  var _a = useComponentContext('MessageLivestream').MessageTimestamp,\n      MessageTimestamp = _a === void 0 ? DefaultTimestamp : _a;\n\n  var _b = useMessageContext('MessageLivestream'),\n      getMessageActions = _b.getMessageActions,\n      handleOpenThread = _b.handleOpenThread,\n      initialMessage = _b.initialMessage,\n      message = _b.message,\n      threadList = _b.threadList;\n\n  var _c = useState(false),\n      actionsBoxOpen = _c[0],\n      setActionsBoxOpen = _c[1];\n\n  var hideOptions = useCallback(function () {\n    return setActionsBoxOpen(false);\n  }, []);\n  var messageDeletedAt = !!message.deleted_at;\n  var messageWrapper = messageWrapperRef === null || messageWrapperRef === void 0 ? void 0 : messageWrapperRef.current;\n  var messageActions = getMessageActions();\n  var showActionsBox = showMessageActionsBox(messageActions);\n  var shouldShowReactions = messageActions.indexOf(MESSAGE_ACTIONS.react) > -1;\n  var shouldShowReplies = messageActions.indexOf(MESSAGE_ACTIONS.reply) > -1 && !threadList;\n  useEffect(function () {\n    if (messageWrapper) {\n      messageWrapper.addEventListener('mouseleave', hideOptions);\n    }\n\n    return function () {\n      if (messageWrapper) {\n        messageWrapper.removeEventListener('mouseleave', hideOptions);\n      }\n    };\n  }, [messageWrapper, hideOptions]);\n  useEffect(function () {\n    if (messageDeletedAt) {\n      document.removeEventListener('click', hideOptions);\n    }\n  }, [messageDeletedAt, hideOptions]);\n  useEffect(function () {\n    if (actionsBoxOpen) {\n      document.addEventListener('click', hideOptions);\n    } else {\n      document.removeEventListener('click', hideOptions);\n    }\n\n    return function () {\n      document.removeEventListener('click', hideOptions);\n    };\n  }, [actionsBoxOpen, hideOptions]);\n\n  if (initialMessage || !message || message.type === 'error' || message.type === 'system' || message.type === 'ephemeral' || message.status === 'failed' || message.status === 'sending') {\n    return null;\n  }\n\n  return React.createElement(\"div\", {\n    className: \"str-chat__message-livestream-actions\",\n    \"data-testid\": 'message-livestream-actions'\n  }, React.createElement(MessageTimestamp, {\n    customClass: 'str-chat__message-livestream-time'\n  }), shouldShowReactions && React.createElement(\"span\", {\n    \"data-testid\": 'message-livestream-reactions-action',\n    onClick: onReactionListClick\n  }, React.createElement(\"span\", null, React.createElement(ReactionIcon, null))), shouldShowReplies && React.createElement(\"span\", {\n    \"data-testid\": 'message-livestream-thread-action',\n    onClick: handleOpenThread\n  }, React.createElement(ThreadIcon, null)), showActionsBox && React.createElement(MessageActions, {\n    inline: true\n  }));\n};\n\nvar MemoizedMessageLivestream = React.memo(MessageLivestreamWithContext, areMessageUIPropsEqual);\n/**\n * @deprecated - This UI component will be removed in the next major release.\n *\n * Handles the rendering of a message and depends on the Message component for all the logic.\n * Implements the look and feel for a livestream use case.\n */\n\nexport var MessageLivestream = function (props) {\n  var messageContext = useMessageContext('MessageLivestream');\n  var messageWrapperRef = useRef(null);\n  var reactionSelectorRef = useRef(null);\n  var message = props.message || messageContext.message;\n\n  var _a = useReactionClick(message, reactionSelectorRef, messageWrapperRef),\n      isReactionEnabled = _a.isReactionEnabled,\n      onReactionListClick = _a.onReactionListClick,\n      showDetailedReactions = _a.showDetailedReactions;\n\n  return React.createElement(MemoizedMessageLivestream, __assign({}, messageContext, {\n    isReactionEnabled: isReactionEnabled,\n    messageWrapperRef: messageWrapperRef,\n    onReactionListClick: onReactionListClick,\n    reactionSelectorRef: reactionSelectorRef,\n    showDetailedReactions: showDetailedReactions\n  }, props));\n};","map":{"version":3,"sources":["C:/Users/Usuario/Documents/GitHub/discord-clone-app/client/node_modules/stream-chat-react/dist/components/Message/MessageLivestream.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","React","useCallback","useEffect","useMemo","useRef","useState","MessageDeleted","DefaultMessageDeleted","MessageRepliesCountButton","DefaultMessageRepliesCountButton","MessageTimestamp","DefaultTimestamp","useReactionClick","PinIndicator","DefaultPinIndicator","ErrorIcon","ReactionIcon","ThreadIcon","QuotedMessage","DefaultQuotedMessage","areMessageUIPropsEqual","MESSAGE_ACTIONS","showMessageActionsBox","Avatar","DefaultAvatar","CUSTOM_MESSAGE_TYPE","MessageActions","EditMessageForm","DefaultEditMessageForm","MessageInput","ReactionSelector","DefaultReactionSelector","SimpleReactionsList","DefaultReactionsList","useComponentContext","useMessageContext","useTranslationContext","renderText","defaultRenderText","isOnlyEmojis","MessageLivestreamWithContext","props","_a","_b","_c","_d","_e","_f","_g","_h","_j","_k","clearEditingState","editing","groupStyles","handleAction","handleOpenThread","handleRetry","initialMessage","isReactionEnabled","message","messageWrapperRef","onMentionsClickMessage","onMentionsHoverMessage","onReactionListClick","onUserClick","onUserHover","reactionSelectorRef","_l","showDetailedReactions","unsafeHTML","_m","Attachment","_o","_p","EditMessageInput","_q","_r","_s","_t","_u","ReactionsList","_v","_w","userLanguage","messageTextToRender","i18n","text","messageText","mentioned_users","firstGroupStyle","customType","date","deleted_at","createElement","className","image","user","name","id","onClick","onMouseOver","size","Input","Fragment","pinned","type","status","ref","MessageLivestreamActions","quoted_message","html","dangerouslySetInnerHTML","__html","command","errorStatusCode","undefined","attachments","actionHandler","reply_count","getMessageActions","threadList","actionsBoxOpen","setActionsBoxOpen","hideOptions","messageDeletedAt","messageWrapper","current","messageActions","showActionsBox","shouldShowReactions","indexOf","react","shouldShowReplies","reply","addEventListener","removeEventListener","document","customClass","inline","MemoizedMessageLivestream","memo","MessageLivestream","messageContext"],"mappings":"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","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { MessageDeleted as DefaultMessageDeleted } from './MessageDeleted';\nimport { MessageRepliesCountButton as DefaultMessageRepliesCountButton } from './MessageRepliesCountButton';\nimport { MessageTimestamp as DefaultTimestamp } from './MessageTimestamp';\nimport { useReactionClick } from './hooks';\nimport { PinIndicator as DefaultPinIndicator, ErrorIcon, ReactionIcon, ThreadIcon } from './icons';\nimport { QuotedMessage as DefaultQuotedMessage } from './QuotedMessage';\nimport { areMessageUIPropsEqual, MESSAGE_ACTIONS, showMessageActionsBox } from './utils';\nimport { Avatar as DefaultAvatar } from '../Avatar';\nimport { CUSTOM_MESSAGE_TYPE } from '../../constants/messageTypes';\nimport { MessageActions } from '../MessageActions';\nimport { EditMessageForm as DefaultEditMessageForm, MessageInput } from '../MessageInput';\nimport { ReactionSelector as DefaultReactionSelector, SimpleReactionsList as DefaultReactionsList, } from '../Reactions';\nimport { useComponentContext } from '../../context/ComponentContext';\nimport { useMessageContext } from '../../context/MessageContext';\nimport { useTranslationContext } from '../../context/TranslationContext';\nimport { renderText as defaultRenderText, isOnlyEmojis } from '../../utils';\nvar MessageLivestreamWithContext = function (props) {\n    var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k;\n    var clearEditingState = props.clearEditingState, editing = props.editing, groupStyles = props.groupStyles, handleAction = props.handleAction, handleOpenThread = props.handleOpenThread, handleRetry = props.handleRetry, initialMessage = props.initialMessage, isReactionEnabled = props.isReactionEnabled, message = props.message, messageWrapperRef = props.messageWrapperRef, onMentionsClickMessage = props.onMentionsClickMessage, onMentionsHoverMessage = props.onMentionsHoverMessage, onReactionListClick = props.onReactionListClick, onUserClick = props.onUserClick, onUserHover = props.onUserHover, reactionSelectorRef = props.reactionSelectorRef, _l = props.renderText, renderText = _l === void 0 ? defaultRenderText : _l, showDetailedReactions = props.showDetailedReactions, unsafeHTML = props.unsafeHTML;\n    var _m = useComponentContext('MessageLivestream'), Attachment = _m.Attachment, _o = _m.Avatar, Avatar = _o === void 0 ? DefaultAvatar : _o, _p = _m.EditMessageInput, EditMessageInput = _p === void 0 ? DefaultEditMessageForm : _p, _q = _m.MessageDeleted, MessageDeleted = _q === void 0 ? DefaultMessageDeleted : _q, _r = _m.MessageRepliesCountButton, MessageRepliesCountButton = _r === void 0 ? DefaultMessageRepliesCountButton : _r, _s = _m.PinIndicator, PinIndicator = _s === void 0 ? DefaultPinIndicator : _s, _t = _m.QuotedMessage, QuotedMessage = _t === void 0 ? DefaultQuotedMessage : _t, _u = _m.ReactionsList, ReactionsList = _u === void 0 ? DefaultReactionsList : _u, _v = _m.ReactionSelector, ReactionSelector = _v === void 0 ? DefaultReactionSelector : _v;\n    var _w = useTranslationContext('MessageLivestream'), t = _w.t, userLanguage = _w.userLanguage;\n    var messageTextToRender = ((_a = message.i18n) === null || _a === void 0 ? void 0 : _a[userLanguage + \"_text\"]) || message.text;\n    var messageText = useMemo(function () { return renderText(messageTextToRender, message.mentioned_users); }, [\n        message.mentioned_users,\n        messageTextToRender,\n    ]);\n    var firstGroupStyle = groupStyles ? groupStyles[0] : 'single';\n    if (message.customType === CUSTOM_MESSAGE_TYPE.date) {\n        return null;\n    }\n    if (message.deleted_at) {\n        return React.createElement(MessageDeleted, { message: message });\n    }\n    if (editing) {\n        return (React.createElement(\"div\", { className: \"str-chat__message-team str-chat__message-team--\" + firstGroupStyle + \" str-chat__message-team--editing\", \"data-testid\": 'message-livestream-edit' },\n            (firstGroupStyle === 'top' || firstGroupStyle === 'single') && (React.createElement(\"div\", { className: 'str-chat__message-team-meta' },\n                React.createElement(Avatar, { image: (_b = message.user) === null || _b === void 0 ? void 0 : _b.image, name: ((_c = message.user) === null || _c === void 0 ? void 0 : _c.name) || ((_d = message.user) === null || _d === void 0 ? void 0 : _d.id), onClick: onUserClick, onMouseOver: onUserHover, size: 40 }))),\n            React.createElement(MessageInput, { clearEditingState: clearEditingState, Input: EditMessageInput, message: message })));\n    }\n    return (React.createElement(React.Fragment, null,\n        message.pinned && (React.createElement(\"div\", { className: 'str-chat__message-livestream-pin-indicator' },\n            React.createElement(PinIndicator, { message: message, t: t }))),\n        React.createElement(\"div\", { className: \"str-chat__message-livestream str-chat__message-livestream--\" + firstGroupStyle + \" str-chat__message-livestream--\" + message.type + \" str-chat__message-livestream--\" + message.status + \" \" + (initialMessage ? 'str-chat__message-livestream--initial-message' : '') + \" \" + (message.pinned ? 'pinned-message' : ''), \"data-testid\": 'message-livestream', ref: messageWrapperRef },\n            showDetailedReactions && isReactionEnabled && (React.createElement(ReactionSelector, { ref: reactionSelectorRef })),\n            React.createElement(MessageLivestreamActions, { messageWrapperRef: messageWrapperRef, onReactionListClick: onReactionListClick }),\n            React.createElement(\"div\", { className: 'str-chat__message-livestream-left' },\n                React.createElement(Avatar, { image: (_e = message.user) === null || _e === void 0 ? void 0 : _e.image, name: ((_f = message.user) === null || _f === void 0 ? void 0 : _f.name) || ((_g = message.user) === null || _g === void 0 ? void 0 : _g.id), onClick: onUserClick, onMouseOver: onUserHover, size: 30 })),\n            React.createElement(\"div\", { className: 'str-chat__message-livestream-right' },\n                React.createElement(\"div\", { className: 'str-chat__message-livestream-content' },\n                    React.createElement(\"div\", { className: 'str-chat__message-livestream-author' },\n                        React.createElement(\"strong\", null, ((_h = message.user) === null || _h === void 0 ? void 0 : _h.name) || ((_j = message.user) === null || _j === void 0 ? void 0 : _j.id)),\n                        message.type === 'error' && (React.createElement(\"div\", { className: 'str-chat__message-team-error-header' }, t('Only visible to you')))),\n                    React.createElement(\"div\", { className: isOnlyEmojis(message.text) ? 'str-chat__message-livestream-text--is-emoji' : '', \"data-testid\": 'message-livestream-text', onClick: onMentionsClickMessage, onMouseOver: onMentionsHoverMessage },\n                        message.quoted_message && (React.createElement(\"div\", { className: 'livestream-quoted-message' },\n                            React.createElement(QuotedMessage, null))),\n                        message.type !== 'error' &&\n                            message.status !== 'failed' &&\n                            !unsafeHTML &&\n                            messageText,\n                        message.type !== 'error' &&\n                            message.status !== 'failed' &&\n                            unsafeHTML &&\n                            !!message.html && React.createElement(\"div\", { dangerouslySetInnerHTML: { __html: message.html } }),\n                        message.type === 'error' && !message.command && (React.createElement(\"p\", { \"data-testid\": 'message-livestream-error' },\n                            React.createElement(ErrorIcon, null),\n                            message.text)),\n                        message.type === 'error' && message.command && (React.createElement(\"p\", { \"data-testid\": 'message-livestream-command-error' },\n                            React.createElement(ErrorIcon, null),\n                            React.createElement(\"strong\", null,\n                                \"/\",\n                                message.command),\n                            \" is not a valid command\")),\n                        message.status === 'failed' && (React.createElement(\"p\", { onClick: message.errorStatusCode !== 403 ? function () { return handleRetry(message); } : undefined },\n                            React.createElement(ErrorIcon, null),\n                            message.errorStatusCode !== 403\n                                ? t('Message Failed 路 Click to try again')\n                                : t('Message Failed 路 Unauthorized')))),\n                    ((_k = message.attachments) === null || _k === void 0 ? void 0 : _k.length) ? (React.createElement(Attachment, { actionHandler: handleAction, attachments: message.attachments })) : null,\n                    isReactionEnabled && React.createElement(ReactionsList, null),\n                    !initialMessage && (React.createElement(MessageRepliesCountButton, { onClick: handleOpenThread, reply_count: message.reply_count })))))));\n};\nvar MessageLivestreamActions = function (props) {\n    var messageWrapperRef = props.messageWrapperRef, onReactionListClick = props.onReactionListClick;\n    var _a = useComponentContext('MessageLivestream').MessageTimestamp, MessageTimestamp = _a === void 0 ? DefaultTimestamp : _a;\n    var _b = useMessageContext('MessageLivestream'), getMessageActions = _b.getMessageActions, handleOpenThread = _b.handleOpenThread, initialMessage = _b.initialMessage, message = _b.message, threadList = _b.threadList;\n    var _c = useState(false), actionsBoxOpen = _c[0], setActionsBoxOpen = _c[1];\n    var hideOptions = useCallback(function () { return setActionsBoxOpen(false); }, []);\n    var messageDeletedAt = !!message.deleted_at;\n    var messageWrapper = messageWrapperRef === null || messageWrapperRef === void 0 ? void 0 : messageWrapperRef.current;\n    var messageActions = getMessageActions();\n    var showActionsBox = showMessageActionsBox(messageActions);\n    var shouldShowReactions = messageActions.indexOf(MESSAGE_ACTIONS.react) > -1;\n    var shouldShowReplies = messageActions.indexOf(MESSAGE_ACTIONS.reply) > -1 && !threadList;\n    useEffect(function () {\n        if (messageWrapper) {\n            messageWrapper.addEventListener('mouseleave', hideOptions);\n        }\n        return function () {\n            if (messageWrapper) {\n                messageWrapper.removeEventListener('mouseleave', hideOptions);\n            }\n        };\n    }, [messageWrapper, hideOptions]);\n    useEffect(function () {\n        if (messageDeletedAt) {\n            document.removeEventListener('click', hideOptions);\n        }\n    }, [messageDeletedAt, hideOptions]);\n    useEffect(function () {\n        if (actionsBoxOpen) {\n            document.addEventListener('click', hideOptions);\n        }\n        else {\n            document.removeEventListener('click', hideOptions);\n        }\n        return function () {\n            document.removeEventListener('click', hideOptions);\n        };\n    }, [actionsBoxOpen, hideOptions]);\n    if (initialMessage ||\n        !message ||\n        message.type === 'error' ||\n        message.type === 'system' ||\n        message.type === 'ephemeral' ||\n        message.status === 'failed' ||\n        message.status === 'sending') {\n        return null;\n    }\n    return (React.createElement(\"div\", { className: \"str-chat__message-livestream-actions\", \"data-testid\": 'message-livestream-actions' },\n        React.createElement(MessageTimestamp, { customClass: 'str-chat__message-livestream-time' }),\n        shouldShowReactions && (React.createElement(\"span\", { \"data-testid\": 'message-livestream-reactions-action', onClick: onReactionListClick },\n            React.createElement(\"span\", null,\n                React.createElement(ReactionIcon, null)))),\n        shouldShowReplies && (React.createElement(\"span\", { \"data-testid\": 'message-livestream-thread-action', onClick: handleOpenThread },\n            React.createElement(ThreadIcon, null))),\n        showActionsBox && React.createElement(MessageActions, { inline: true })));\n};\nvar MemoizedMessageLivestream = React.memo(MessageLivestreamWithContext, areMessageUIPropsEqual);\n/**\n * @deprecated - This UI component will be removed in the next major release.\n *\n * Handles the rendering of a message and depends on the Message component for all the logic.\n * Implements the look and feel for a livestream use case.\n */\nexport var MessageLivestream = function (props) {\n    var messageContext = useMessageContext('MessageLivestream');\n    var messageWrapperRef = useRef(null);\n    var reactionSelectorRef = useRef(null);\n    var message = props.message || messageContext.message;\n    var _a = useReactionClick(message, reactionSelectorRef, messageWrapperRef), isReactionEnabled = _a.isReactionEnabled, onReactionListClick = _a.onReactionListClick, showDetailedReactions = _a.showDetailedReactions;\n    return (React.createElement(MemoizedMessageLivestream, __assign({}, messageContext, { isReactionEnabled: isReactionEnabled, messageWrapperRef: messageWrapperRef, onReactionListClick: onReactionListClick, reactionSelectorRef: reactionSelectorRef, showDetailedReactions: showDetailedReactions }, props)));\n};\n"]},"metadata":{},"sourceType":"module"}