{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function () {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n\n        case 7:\n          op = _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n\n            _.ops.push(op);\n\n            break;\n          }\n\n          if (t[2]) _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n      }\n\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { Virtuoso } from 'react-virtuoso';\nimport { GiphyPreviewMessage as DefaultGiphyPreviewMessage } from './GiphyPreviewMessage';\nimport { useGiphyPreview } from './hooks/useGiphyPreview';\nimport { useNewMessageNotification } from './hooks/useNewMessageNotification';\nimport { usePrependedMessagesCount } from './hooks/usePrependMessagesCount';\nimport { useShouldForceScrollToBottom } from './hooks/useShouldForceScrollToBottom';\nimport { MessageNotification as DefaultMessageNotification } from './MessageNotification';\nimport { MessageListNotifications as DefaultMessageListNotifications } from './MessageListNotifications';\nimport { processMessages } from './utils';\nimport { CUSTOM_MESSAGE_TYPE } from '../../constants/messageTypes';\nimport { DateSeparator as DefaultDateSeparator } from '../DateSeparator/DateSeparator';\nimport { EmptyStateIndicator as DefaultEmptyStateIndicator } from '../EmptyStateIndicator/EmptyStateIndicator';\nimport { EventComponent } from '../EventComponent/EventComponent';\nimport { LoadingIndicator as DefaultLoadingIndicator } from '../Loading/LoadingIndicator';\nimport { Message, MessageSimple } from '../Message';\nimport { useChannelActionContext } from '../../context/ChannelActionContext';\nimport { useChannelStateContext } from '../../context/ChannelStateContext';\nimport { useChatContext } from '../../context/ChatContext';\nimport { useComponentContext } from '../../context/ComponentContext';\nimport { isDate } from '../../context/TranslationContext';\nvar PREPEND_OFFSET = Math.pow(10, 7);\n\nfunction captureResizeObserverExceededError(e) {\n  if (e.message === 'ResizeObserver loop completed with undelivered notifications.' || e.message === 'ResizeObserver loop limit exceeded') {\n    e.stopImmediatePropagation();\n  }\n}\n\nfunction useCaptureResizeObserverExceededError() {\n  useEffect(function () {\n    window.addEventListener('error', captureResizeObserverExceededError);\n    return function () {\n      window.removeEventListener('error', captureResizeObserverExceededError);\n    };\n  }, []);\n}\n\nfunction fractionalItemSize(element) {\n  return element.getBoundingClientRect().height;\n}\n\nfunction findMessageIndex(messages, id) {\n  return messages.findIndex(function (message) {\n    return message.id === id;\n  });\n}\n\nfunction calculateInitialTopMostItemIndex(messages, highlightedMessageId) {\n  if (highlightedMessageId) {\n    var index = findMessageIndex(messages, highlightedMessageId);\n\n    if (index !== -1) {\n      return {\n        align: 'center',\n        index: index\n      };\n    }\n  }\n\n  return messages.length - 1;\n}\n\nvar VirtualizedMessageListWithContext = function (props) {\n  var additionalVirtuosoProps = props.additionalVirtuosoProps,\n      channel = props.channel,\n      closeReactionSelectorOnClick = props.closeReactionSelectorOnClick,\n      customMessageRenderer = props.customMessageRenderer,\n      defaultItemHeight = props.defaultItemHeight,\n      _a = props.disableDateSeparator,\n      disableDateSeparator = _a === void 0 ? true : _a,\n      hasMore = props.hasMore,\n      hasMoreNewer = props.hasMoreNewer,\n      _b = props.hideDeletedMessages,\n      hideDeletedMessages = _b === void 0 ? false : _b,\n      _c = props.hideNewMessageSeparator,\n      hideNewMessageSeparator = _c === void 0 ? false : _c,\n      highlightedMessageId = props.highlightedMessageId,\n      jumpToLatestMessage = props.jumpToLatestMessage,\n      loadingMore = props.loadingMore,\n      loadMore = props.loadMore,\n      loadMoreNewer = props.loadMoreNewer,\n      propMessage = props.Message,\n      _d = props.messageLimit,\n      messageLimit = _d === void 0 ? 100 : _d,\n      messages = props.messages,\n      notifications = props.notifications,\n      // TODO: refactor to scrollSeekPlaceHolderConfiguration and components.ScrollSeekPlaceholder, like the Virtuoso Component\n  _e = props.overscan,\n      // TODO: refactor to scrollSeekPlaceHolderConfiguration and components.ScrollSeekPlaceholder, like the Virtuoso Component\n  overscan = _e === void 0 ? 0 : _e,\n      scrollSeekPlaceHolder = props.scrollSeekPlaceHolder,\n      _f = props.scrollToLatestMessageOnFocus,\n      scrollToLatestMessageOnFocus = _f === void 0 ? false : _f,\n      _g = props.separateGiphyPreview,\n      separateGiphyPreview = _g === void 0 ? false : _g,\n      _h = props.shouldGroupByUser,\n      shouldGroupByUser = _h === void 0 ? false : _h,\n      _j = props.stickToBottomScrollBehavior,\n      stickToBottomScrollBehavior = _j === void 0 ? 'smooth' : _j,\n      suppressAutoscroll = props.suppressAutoscroll; // Stops errors generated from react-virtuoso to bubble up\n  // to Sentry or other tracking tools.\n\n  useCaptureResizeObserverExceededError();\n\n  var _k = useComponentContext('VirtualizedMessageList'),\n      _l = _k.DateSeparator,\n      DateSeparator = _l === void 0 ? DefaultDateSeparator : _l,\n      _m = _k.EmptyStateIndicator,\n      EmptyStateIndicator = _m === void 0 ? DefaultEmptyStateIndicator : _m,\n      _o = _k.GiphyPreviewMessage,\n      GiphyPreviewMessage = _o === void 0 ? DefaultGiphyPreviewMessage : _o,\n      _p = _k.LoadingIndicator,\n      LoadingIndicator = _p === void 0 ? DefaultLoadingIndicator : _p,\n      _q = _k.MessageListNotifications,\n      MessageListNotifications = _q === void 0 ? DefaultMessageListNotifications : _q,\n      _r = _k.MessageNotification,\n      MessageNotification = _r === void 0 ? DefaultMessageNotification : _r,\n      _s = _k.MessageSystem,\n      MessageSystem = _s === void 0 ? EventComponent : _s,\n      _t = _k.TypingIndicator,\n      TypingIndicator = _t === void 0 ? null : _t,\n      _u = _k.VirtualMessage,\n      contextMessage = _u === void 0 ? MessageSimple : _u;\n\n  var _v = useChatContext('VirtualizedMessageList'),\n      client = _v.client,\n      customClasses = _v.customClasses;\n\n  var lastRead = useMemo(function () {\n    var _a;\n\n    return (_a = channel.lastRead) === null || _a === void 0 ? void 0 : _a.call(channel);\n  }, [channel]);\n  var MessageUIComponent = propMessage || contextMessage;\n\n  var _w = useGiphyPreview(separateGiphyPreview),\n      giphyPreviewMessage = _w.giphyPreviewMessage,\n      setGiphyPreviewMessage = _w.setGiphyPreviewMessage;\n\n  var processedMessages = useMemo(function () {\n    if (typeof messages === 'undefined') {\n      return [];\n    }\n\n    if (disableDateSeparator && !hideDeletedMessages && hideNewMessageSeparator && !separateGiphyPreview) {\n      return messages;\n    }\n\n    return processMessages({\n      enableDateSeparator: !disableDateSeparator,\n      hideDeletedMessages: hideDeletedMessages,\n      hideNewMessageSeparator: hideNewMessageSeparator,\n      lastRead: lastRead,\n      messages: messages,\n      setGiphyPreviewMessage: setGiphyPreviewMessage,\n      userId: client.userID || ''\n    });\n  }, [disableDateSeparator, hideDeletedMessages, hideNewMessageSeparator, lastRead, messages, messages === null || messages === void 0 ? void 0 : messages.length, client.userID]);\n  var virtuoso = useRef(null);\n\n  var _x = useNewMessageNotification(processedMessages, client.userID, hasMoreNewer),\n      atBottom = _x.atBottom,\n      newMessagesNotification = _x.newMessagesNotification,\n      setNewMessagesNotification = _x.setNewMessagesNotification;\n\n  var scrollToBottom = useCallback(function () {\n    return __awaiter(void 0, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (!hasMoreNewer) return [3\n            /*break*/\n            , 2];\n            return [4\n            /*yield*/\n            , jumpToLatestMessage()];\n\n          case 1:\n            _a.sent();\n\n            return [2\n            /*return*/\n            ];\n\n          case 2:\n            if (virtuoso.current) {\n              virtuoso.current.scrollToIndex(processedMessages.length - 1);\n            }\n\n            setNewMessagesNotification(false);\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  }, [virtuoso, processedMessages, setNewMessagesNotification, processedMessages.length, hasMoreNewer, jumpToLatestMessage]);\n\n  var _y = React.useState(false),\n      newMessagesReceivedInBackground = _y[0],\n      setNewMessagesReceivedInBackground = _y[1];\n\n  var resetNewMessagesReceivedInBackground = useCallback(function () {\n    setNewMessagesReceivedInBackground(false);\n  }, []);\n  useEffect(function () {\n    setNewMessagesReceivedInBackground(true);\n  }, [messages]);\n  var scrollToBottomIfConfigured = useCallback(function (event) {\n    if (scrollToLatestMessageOnFocus && event.target === window) {\n      if (newMessagesReceivedInBackground) {\n        setTimeout(scrollToBottom, 100);\n      }\n    }\n  }, [scrollToLatestMessageOnFocus, scrollToBottom, newMessagesReceivedInBackground]);\n  useEffect(function () {\n    if (typeof window !== 'undefined') {\n      window.addEventListener('focus', scrollToBottomIfConfigured);\n      window.addEventListener('blur', resetNewMessagesReceivedInBackground);\n    }\n\n    return function () {\n      window.removeEventListener('focus', scrollToBottomIfConfigured);\n      window.removeEventListener('blur', resetNewMessagesReceivedInBackground);\n    };\n  }, [scrollToBottomIfConfigured]);\n  var numItemsPrepended = usePrependedMessagesCount(processedMessages);\n  /**\n   * Logic to update the key of the virtuoso component when the list jumps to a new location.\n   */\n\n  var _z = useState(+new Date()),\n      messageSetKey = _z[0],\n      setMessageSetKey = _z[1];\n\n  var firstMessageId = useRef();\n  useEffect(function () {\n    var _a;\n\n    var continuousSet = messages && messages.find(function (message) {\n      return message.id === firstMessageId.current;\n    });\n\n    if (!continuousSet) {\n      setMessageSetKey(+new Date());\n    }\n\n    firstMessageId.current = (_a = messages === null || messages === void 0 ? void 0 : messages[0]) === null || _a === void 0 ? void 0 : _a.id;\n  }, [messages]);\n  var shouldForceScrollToBottom = useShouldForceScrollToBottom(processedMessages, client.userID);\n\n  var followOutput = function (isAtBottom) {\n    if (hasMoreNewer || suppressAutoscroll) {\n      return false;\n    }\n\n    if (shouldForceScrollToBottom()) {\n      return isAtBottom ? stickToBottomScrollBehavior : 'auto';\n    } // a message from another user has been received - don't scroll to bottom unless already there\n\n\n    return isAtBottom ? stickToBottomScrollBehavior : false;\n  };\n\n  var messageRenderer = useCallback(function (messageList, virtuosoIndex) {\n    var _a, _b, _c, _d, _e, _f, _g, _h;\n\n    var streamMessageIndex = virtuosoIndex + numItemsPrepended - PREPEND_OFFSET; // use custom renderer supplied by client if present and skip the rest\n\n    if (customMessageRenderer) {\n      return customMessageRenderer(messageList, streamMessageIndex);\n    }\n\n    var message = messageList[streamMessageIndex];\n\n    if (message.customType === CUSTOM_MESSAGE_TYPE.date && message.date && isDate(message.date)) {\n      return React.createElement(DateSeparator, {\n        date: message.date,\n        unread: message.unread\n      });\n    }\n\n    if (!message) return React.createElement(\"div\", {\n      style: {\n        height: '1px'\n      }\n    }); // returning null or zero height breaks the virtuoso\n\n    if (message.type === 'system') {\n      return React.createElement(MessageSystem, {\n        message: message\n      });\n    }\n\n    var groupedByUser = shouldGroupByUser && streamMessageIndex > 0 && ((_a = message.user) === null || _a === void 0 ? void 0 : _a.id) === ((_b = messageList[streamMessageIndex - 1].user) === null || _b === void 0 ? void 0 : _b.id);\n    var firstOfGroup = shouldGroupByUser && ((_c = message.user) === null || _c === void 0 ? void 0 : _c.id) !== ((_e = (_d = messageList[streamMessageIndex - 1]) === null || _d === void 0 ? void 0 : _d.user) === null || _e === void 0 ? void 0 : _e.id);\n    var endOfGroup = shouldGroupByUser && ((_f = message.user) === null || _f === void 0 ? void 0 : _f.id) !== ((_h = (_g = messageList[streamMessageIndex + 1]) === null || _g === void 0 ? void 0 : _g.user) === null || _h === void 0 ? void 0 : _h.id);\n    return React.createElement(Message, {\n      closeReactionSelectorOnClick: closeReactionSelectorOnClick,\n      customMessageActions: props.customMessageActions,\n      endOfGroup: endOfGroup,\n      firstOfGroup: firstOfGroup,\n      groupedByUser: groupedByUser,\n      message: message,\n      Message: MessageUIComponent,\n      messageActions: props.messageActions\n    });\n  }, [customMessageRenderer, shouldGroupByUser, numItemsPrepended]);\n  var virtuosoComponents = useMemo(function () {\n    var EmptyPlaceholder = function () {\n      return React.createElement(React.Fragment, null, EmptyStateIndicator && React.createElement(EmptyStateIndicator, {\n        listType: 'message'\n      }));\n    };\n\n    var Header = function () {\n      return loadingMore ? React.createElement(\"div\", {\n        className: 'str-chat__virtual-list__loading'\n      }, React.createElement(LoadingIndicator, {\n        size: 20\n      })) : React.createElement(React.Fragment, null);\n    };\n\n    var virtualMessageClass = (customClasses === null || customClasses === void 0 ? void 0 : customClasses.virtualMessage) || 'str-chat__virtual-list-message-wrapper'; // using 'display: inline-block' traps CSS margins of the item elements, preventing incorrect item measurements\n\n    var Item = function (props) {\n      return React.createElement(\"div\", __assign({}, props, {\n        className: virtualMessageClass\n      }));\n    };\n\n    var Footer = function () {\n      return TypingIndicator ? React.createElement(TypingIndicator, {\n        avatarSize: 24\n      }) : React.createElement(React.Fragment, null);\n    };\n\n    return {\n      EmptyPlaceholder: EmptyPlaceholder,\n      Footer: Footer,\n      Header: Header,\n      Item: Item\n    };\n  }, [loadingMore]);\n\n  var atBottomStateChange = function (isAtBottom) {\n    atBottom.current = isAtBottom;\n\n    if (isAtBottom && newMessagesNotification) {\n      setNewMessagesNotification(false);\n    }\n  };\n\n  var startReached = function () {\n    if (hasMore && loadMore) {\n      loadMore(messageLimit);\n    }\n  };\n\n  var endReached = function () {\n    if (hasMoreNewer && loadMoreNewer) {\n      loadMoreNewer(messageLimit);\n    }\n  };\n\n  useEffect(function () {\n    var _a;\n\n    if (highlightedMessageId) {\n      var index = findMessageIndex(processedMessages, highlightedMessageId);\n\n      if (index !== -1) {\n        (_a = virtuoso.current) === null || _a === void 0 ? void 0 : _a.scrollToIndex({\n          align: 'center',\n          index: index\n        });\n      }\n    }\n  }, [highlightedMessageId]);\n  if (!processedMessages) return null;\n  return React.createElement(React.Fragment, null, React.createElement(\"div\", {\n    className: (customClasses === null || customClasses === void 0 ? void 0 : customClasses.virtualizedMessageList) || 'str-chat__virtual-list'\n  }, React.createElement(Virtuoso, __assign({\n    atBottomStateChange: atBottomStateChange,\n    components: virtuosoComponents,\n    endReached: endReached,\n    firstItemIndex: PREPEND_OFFSET - numItemsPrepended,\n    followOutput: followOutput,\n    increaseViewportBy: {\n      bottom: 200,\n      top: 0\n    },\n    initialTopMostItemIndex: calculateInitialTopMostItemIndex(processedMessages, highlightedMessageId),\n    itemContent: function (i) {\n      return messageRenderer(processedMessages, i);\n    },\n    itemSize: fractionalItemSize,\n    key: messageSetKey,\n    overscan: overscan,\n    ref: virtuoso,\n    startReached: startReached,\n    style: {\n      overflowX: 'hidden'\n    },\n    totalCount: processedMessages.length\n  }, additionalVirtuosoProps, scrollSeekPlaceHolder ? {\n    scrollSeek: scrollSeekPlaceHolder\n  } : {}, defaultItemHeight ? {\n    defaultItemHeight: defaultItemHeight\n  } : {}))), React.createElement(MessageListNotifications, {\n    hasNewMessages: newMessagesNotification,\n    isNotAtLatestMessageSet: hasMoreNewer,\n    MessageNotification: MessageNotification,\n    notifications: notifications,\n    scrollToBottom: scrollToBottom\n  }), giphyPreviewMessage && React.createElement(GiphyPreviewMessage, {\n    message: giphyPreviewMessage\n  }));\n};\n/**\n * The VirtualizedMessageList component renders a list of messages in a virtualized list.\n * It is a consumer of the React contexts set in [Channel](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Channel/Channel.tsx).\n *\n * **Note**: It works well when there are thousands of messages in a channel, it has a shortcoming though - the message UI should have a fixed height.\n */\n\n\nexport function VirtualizedMessageList(props) {\n  var _a = useChannelActionContext('VirtualizedMessageList'),\n      jumpToLatestMessage = _a.jumpToLatestMessage,\n      loadMore = _a.loadMore,\n      loadMoreNewer = _a.loadMoreNewer;\n\n  var _b = useChannelStateContext('VirtualizedMessageList'),\n      channel = _b.channel,\n      hasMore = _b.hasMore,\n      hasMoreNewer = _b.hasMoreNewer,\n      highlightedMessageId = _b.highlightedMessageId,\n      loadingMore = _b.loadingMore,\n      loadingMoreNewer = _b.loadingMoreNewer,\n      contextMessages = _b.messages,\n      notifications = _b.notifications,\n      suppressAutoscroll = _b.suppressAutoscroll;\n\n  var messages = props.messages || contextMessages;\n  return React.createElement(VirtualizedMessageListWithContext, __assign({\n    channel: channel,\n    hasMore: !!hasMore,\n    hasMoreNewer: !!hasMoreNewer,\n    highlightedMessageId: highlightedMessageId,\n    jumpToLatestMessage: jumpToLatestMessage,\n    loadingMore: !!loadingMore,\n    loadingMoreNewer: !!loadingMoreNewer,\n    loadMore: loadMore,\n    loadMoreNewer: loadMoreNewer,\n    messages: messages,\n    notifications: notifications,\n    suppressAutoscroll: suppressAutoscroll\n  }, props));\n}","map":{"version":3,"sources":["C:/Users/Usuario/Documents/GitHub/discord-clone-app/client/node_modules/stream-chat-react/dist/components/MessageList/VirtualizedMessageList.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","__generator","body","_","label","sent","trys","ops","f","y","g","verb","Symbol","iterator","v","op","TypeError","pop","push","React","useCallback","useEffect","useMemo","useRef","useState","Virtuoso","GiphyPreviewMessage","DefaultGiphyPreviewMessage","useGiphyPreview","useNewMessageNotification","usePrependedMessagesCount","useShouldForceScrollToBottom","MessageNotification","DefaultMessageNotification","MessageListNotifications","DefaultMessageListNotifications","processMessages","CUSTOM_MESSAGE_TYPE","DateSeparator","DefaultDateSeparator","EmptyStateIndicator","DefaultEmptyStateIndicator","EventComponent","LoadingIndicator","DefaultLoadingIndicator","Message","MessageSimple","useChannelActionContext","useChannelStateContext","useChatContext","useComponentContext","isDate","PREPEND_OFFSET","Math","pow","captureResizeObserverExceededError","message","stopImmediatePropagation","useCaptureResizeObserverExceededError","window","addEventListener","removeEventListener","fractionalItemSize","element","getBoundingClientRect","height","findMessageIndex","messages","id","findIndex","calculateInitialTopMostItemIndex","highlightedMessageId","index","align","VirtualizedMessageListWithContext","props","additionalVirtuosoProps","channel","closeReactionSelectorOnClick","customMessageRenderer","defaultItemHeight","_a","disableDateSeparator","hasMore","hasMoreNewer","_b","hideDeletedMessages","_c","hideNewMessageSeparator","jumpToLatestMessage","loadingMore","loadMore","loadMoreNewer","propMessage","_d","messageLimit","notifications","_e","overscan","scrollSeekPlaceHolder","_f","scrollToLatestMessageOnFocus","_g","separateGiphyPreview","_h","shouldGroupByUser","_j","stickToBottomScrollBehavior","suppressAutoscroll","_k","_l","_m","_o","_p","_q","_r","_s","MessageSystem","_t","TypingIndicator","_u","VirtualMessage","contextMessage","_v","client","customClasses","lastRead","MessageUIComponent","_w","giphyPreviewMessage","setGiphyPreviewMessage","processedMessages","enableDateSeparator","userId","userID","virtuoso","_x","atBottom","newMessagesNotification","setNewMessagesNotification","scrollToBottom","current","scrollToIndex","_y","newMessagesReceivedInBackground","setNewMessagesReceivedInBackground","resetNewMessagesReceivedInBackground","scrollToBottomIfConfigured","event","target","setTimeout","numItemsPrepended","_z","Date","messageSetKey","setMessageSetKey","firstMessageId","continuousSet","find","shouldForceScrollToBottom","followOutput","isAtBottom","messageRenderer","messageList","virtuosoIndex","streamMessageIndex","customType","date","createElement","unread","style","type","groupedByUser","user","firstOfGroup","endOfGroup","customMessageActions","messageActions","virtuosoComponents","EmptyPlaceholder","Fragment","listType","Header","className","size","virtualMessageClass","virtualMessage","Item","Footer","avatarSize","atBottomStateChange","startReached","endReached","virtualizedMessageList","components","firstItemIndex","increaseViewportBy","bottom","top","initialTopMostItemIndex","itemContent","itemSize","key","ref","overflowX","totalCount","scrollSeek","hasNewMessages","isNotAtLatestMessageSet","VirtualizedMessageList","loadingMoreNewer","contextMessages"],"mappings":"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","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { Virtuoso, } from 'react-virtuoso';\nimport { GiphyPreviewMessage as DefaultGiphyPreviewMessage } from './GiphyPreviewMessage';\nimport { useGiphyPreview } from './hooks/useGiphyPreview';\nimport { useNewMessageNotification } from './hooks/useNewMessageNotification';\nimport { usePrependedMessagesCount } from './hooks/usePrependMessagesCount';\nimport { useShouldForceScrollToBottom } from './hooks/useShouldForceScrollToBottom';\nimport { MessageNotification as DefaultMessageNotification } from './MessageNotification';\nimport { MessageListNotifications as DefaultMessageListNotifications } from './MessageListNotifications';\nimport { processMessages } from './utils';\nimport { CUSTOM_MESSAGE_TYPE } from '../../constants/messageTypes';\nimport { DateSeparator as DefaultDateSeparator } from '../DateSeparator/DateSeparator';\nimport { EmptyStateIndicator as DefaultEmptyStateIndicator } from '../EmptyStateIndicator/EmptyStateIndicator';\nimport { EventComponent } from '../EventComponent/EventComponent';\nimport { LoadingIndicator as DefaultLoadingIndicator } from '../Loading/LoadingIndicator';\nimport { Message, MessageSimple } from '../Message';\nimport { useChannelActionContext, } from '../../context/ChannelActionContext';\nimport { useChannelStateContext, } from '../../context/ChannelStateContext';\nimport { useChatContext } from '../../context/ChatContext';\nimport { useComponentContext } from '../../context/ComponentContext';\nimport { isDate } from '../../context/TranslationContext';\nvar PREPEND_OFFSET = Math.pow(10, 7);\nfunction captureResizeObserverExceededError(e) {\n    if (e.message === 'ResizeObserver loop completed with undelivered notifications.' ||\n        e.message === 'ResizeObserver loop limit exceeded') {\n        e.stopImmediatePropagation();\n    }\n}\nfunction useCaptureResizeObserverExceededError() {\n    useEffect(function () {\n        window.addEventListener('error', captureResizeObserverExceededError);\n        return function () {\n            window.removeEventListener('error', captureResizeObserverExceededError);\n        };\n    }, []);\n}\nfunction fractionalItemSize(element) {\n    return element.getBoundingClientRect().height;\n}\nfunction findMessageIndex(messages, id) {\n    return messages.findIndex(function (message) { return message.id === id; });\n}\nfunction calculateInitialTopMostItemIndex(messages, highlightedMessageId) {\n    if (highlightedMessageId) {\n        var index = findMessageIndex(messages, highlightedMessageId);\n        if (index !== -1) {\n            return { align: 'center', index: index };\n        }\n    }\n    return messages.length - 1;\n}\nvar VirtualizedMessageListWithContext = function (props) {\n    var additionalVirtuosoProps = props.additionalVirtuosoProps, channel = props.channel, closeReactionSelectorOnClick = props.closeReactionSelectorOnClick, customMessageRenderer = props.customMessageRenderer, defaultItemHeight = props.defaultItemHeight, _a = props.disableDateSeparator, disableDateSeparator = _a === void 0 ? true : _a, hasMore = props.hasMore, hasMoreNewer = props.hasMoreNewer, _b = props.hideDeletedMessages, hideDeletedMessages = _b === void 0 ? false : _b, _c = props.hideNewMessageSeparator, hideNewMessageSeparator = _c === void 0 ? false : _c, highlightedMessageId = props.highlightedMessageId, jumpToLatestMessage = props.jumpToLatestMessage, loadingMore = props.loadingMore, loadMore = props.loadMore, loadMoreNewer = props.loadMoreNewer, propMessage = props.Message, _d = props.messageLimit, messageLimit = _d === void 0 ? 100 : _d, messages = props.messages, notifications = props.notifications, \n    // TODO: refactor to scrollSeekPlaceHolderConfiguration and components.ScrollSeekPlaceholder, like the Virtuoso Component\n    _e = props.overscan, \n    // TODO: refactor to scrollSeekPlaceHolderConfiguration and components.ScrollSeekPlaceholder, like the Virtuoso Component\n    overscan = _e === void 0 ? 0 : _e, scrollSeekPlaceHolder = props.scrollSeekPlaceHolder, _f = props.scrollToLatestMessageOnFocus, scrollToLatestMessageOnFocus = _f === void 0 ? false : _f, _g = props.separateGiphyPreview, separateGiphyPreview = _g === void 0 ? false : _g, _h = props.shouldGroupByUser, shouldGroupByUser = _h === void 0 ? false : _h, _j = props.stickToBottomScrollBehavior, stickToBottomScrollBehavior = _j === void 0 ? 'smooth' : _j, suppressAutoscroll = props.suppressAutoscroll;\n    // Stops errors generated from react-virtuoso to bubble up\n    // to Sentry or other tracking tools.\n    useCaptureResizeObserverExceededError();\n    var _k = useComponentContext('VirtualizedMessageList'), _l = _k.DateSeparator, DateSeparator = _l === void 0 ? DefaultDateSeparator : _l, _m = _k.EmptyStateIndicator, EmptyStateIndicator = _m === void 0 ? DefaultEmptyStateIndicator : _m, _o = _k.GiphyPreviewMessage, GiphyPreviewMessage = _o === void 0 ? DefaultGiphyPreviewMessage : _o, _p = _k.LoadingIndicator, LoadingIndicator = _p === void 0 ? DefaultLoadingIndicator : _p, _q = _k.MessageListNotifications, MessageListNotifications = _q === void 0 ? DefaultMessageListNotifications : _q, _r = _k.MessageNotification, MessageNotification = _r === void 0 ? DefaultMessageNotification : _r, _s = _k.MessageSystem, MessageSystem = _s === void 0 ? EventComponent : _s, _t = _k.TypingIndicator, TypingIndicator = _t === void 0 ? null : _t, _u = _k.VirtualMessage, contextMessage = _u === void 0 ? MessageSimple : _u;\n    var _v = useChatContext('VirtualizedMessageList'), client = _v.client, customClasses = _v.customClasses;\n    var lastRead = useMemo(function () { var _a; return (_a = channel.lastRead) === null || _a === void 0 ? void 0 : _a.call(channel); }, [channel]);\n    var MessageUIComponent = propMessage || contextMessage;\n    var _w = useGiphyPreview(separateGiphyPreview), giphyPreviewMessage = _w.giphyPreviewMessage, setGiphyPreviewMessage = _w.setGiphyPreviewMessage;\n    var processedMessages = useMemo(function () {\n        if (typeof messages === 'undefined') {\n            return [];\n        }\n        if (disableDateSeparator &&\n            !hideDeletedMessages &&\n            hideNewMessageSeparator &&\n            !separateGiphyPreview) {\n            return messages;\n        }\n        return processMessages({\n            enableDateSeparator: !disableDateSeparator,\n            hideDeletedMessages: hideDeletedMessages,\n            hideNewMessageSeparator: hideNewMessageSeparator,\n            lastRead: lastRead,\n            messages: messages,\n            setGiphyPreviewMessage: setGiphyPreviewMessage,\n            userId: client.userID || '',\n        });\n    }, [\n        disableDateSeparator,\n        hideDeletedMessages,\n        hideNewMessageSeparator,\n        lastRead,\n        messages,\n        messages === null || messages === void 0 ? void 0 : messages.length,\n        client.userID,\n    ]);\n    var virtuoso = useRef(null);\n    var _x = useNewMessageNotification(processedMessages, client.userID, hasMoreNewer), atBottom = _x.atBottom, newMessagesNotification = _x.newMessagesNotification, setNewMessagesNotification = _x.setNewMessagesNotification;\n    var scrollToBottom = useCallback(function () { return __awaiter(void 0, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    if (!hasMoreNewer) return [3 /*break*/, 2];\n                    return [4 /*yield*/, jumpToLatestMessage()];\n                case 1:\n                    _a.sent();\n                    return [2 /*return*/];\n                case 2:\n                    if (virtuoso.current) {\n                        virtuoso.current.scrollToIndex(processedMessages.length - 1);\n                    }\n                    setNewMessagesNotification(false);\n                    return [2 /*return*/];\n            }\n        });\n    }); }, [\n        virtuoso,\n        processedMessages,\n        setNewMessagesNotification,\n        processedMessages.length,\n        hasMoreNewer,\n        jumpToLatestMessage,\n    ]);\n    var _y = React.useState(false), newMessagesReceivedInBackground = _y[0], setNewMessagesReceivedInBackground = _y[1];\n    var resetNewMessagesReceivedInBackground = useCallback(function () {\n        setNewMessagesReceivedInBackground(false);\n    }, []);\n    useEffect(function () {\n        setNewMessagesReceivedInBackground(true);\n    }, [messages]);\n    var scrollToBottomIfConfigured = useCallback(function (event) {\n        if (scrollToLatestMessageOnFocus && event.target === window) {\n            if (newMessagesReceivedInBackground) {\n                setTimeout(scrollToBottom, 100);\n            }\n        }\n    }, [scrollToLatestMessageOnFocus, scrollToBottom, newMessagesReceivedInBackground]);\n    useEffect(function () {\n        if (typeof window !== 'undefined') {\n            window.addEventListener('focus', scrollToBottomIfConfigured);\n            window.addEventListener('blur', resetNewMessagesReceivedInBackground);\n        }\n        return function () {\n            window.removeEventListener('focus', scrollToBottomIfConfigured);\n            window.removeEventListener('blur', resetNewMessagesReceivedInBackground);\n        };\n    }, [scrollToBottomIfConfigured]);\n    var numItemsPrepended = usePrependedMessagesCount(processedMessages);\n    /**\n     * Logic to update the key of the virtuoso component when the list jumps to a new location.\n     */\n    var _z = useState(+new Date()), messageSetKey = _z[0], setMessageSetKey = _z[1];\n    var firstMessageId = useRef();\n    useEffect(function () {\n        var _a;\n        var continuousSet = messages && messages.find(function (message) { return message.id === firstMessageId.current; });\n        if (!continuousSet) {\n            setMessageSetKey(+new Date());\n        }\n        firstMessageId.current = (_a = messages === null || messages === void 0 ? void 0 : messages[0]) === null || _a === void 0 ? void 0 : _a.id;\n    }, [messages]);\n    var shouldForceScrollToBottom = useShouldForceScrollToBottom(processedMessages, client.userID);\n    var followOutput = function (isAtBottom) {\n        if (hasMoreNewer || suppressAutoscroll) {\n            return false;\n        }\n        if (shouldForceScrollToBottom()) {\n            return isAtBottom ? stickToBottomScrollBehavior : 'auto';\n        }\n        // a message from another user has been received - don't scroll to bottom unless already there\n        return isAtBottom ? stickToBottomScrollBehavior : false;\n    };\n    var messageRenderer = useCallback(function (messageList, virtuosoIndex) {\n        var _a, _b, _c, _d, _e, _f, _g, _h;\n        var streamMessageIndex = virtuosoIndex + numItemsPrepended - PREPEND_OFFSET;\n        // use custom renderer supplied by client if present and skip the rest\n        if (customMessageRenderer) {\n            return customMessageRenderer(messageList, streamMessageIndex);\n        }\n        var message = messageList[streamMessageIndex];\n        if (message.customType === CUSTOM_MESSAGE_TYPE.date && message.date && isDate(message.date)) {\n            return React.createElement(DateSeparator, { date: message.date, unread: message.unread });\n        }\n        if (!message)\n            return React.createElement(\"div\", { style: { height: '1px' } }); // returning null or zero height breaks the virtuoso\n        if (message.type === 'system') {\n            return React.createElement(MessageSystem, { message: message });\n        }\n        var groupedByUser = shouldGroupByUser &&\n            streamMessageIndex > 0 &&\n            ((_a = message.user) === null || _a === void 0 ? void 0 : _a.id) === ((_b = messageList[streamMessageIndex - 1].user) === null || _b === void 0 ? void 0 : _b.id);\n        var firstOfGroup = shouldGroupByUser && ((_c = message.user) === null || _c === void 0 ? void 0 : _c.id) !== ((_e = (_d = messageList[streamMessageIndex - 1]) === null || _d === void 0 ? void 0 : _d.user) === null || _e === void 0 ? void 0 : _e.id);\n        var endOfGroup = shouldGroupByUser && ((_f = message.user) === null || _f === void 0 ? void 0 : _f.id) !== ((_h = (_g = messageList[streamMessageIndex + 1]) === null || _g === void 0 ? void 0 : _g.user) === null || _h === void 0 ? void 0 : _h.id);\n        return (React.createElement(Message, { closeReactionSelectorOnClick: closeReactionSelectorOnClick, customMessageActions: props.customMessageActions, endOfGroup: endOfGroup, firstOfGroup: firstOfGroup, groupedByUser: groupedByUser, message: message, Message: MessageUIComponent, messageActions: props.messageActions }));\n    }, [customMessageRenderer, shouldGroupByUser, numItemsPrepended]);\n    var virtuosoComponents = useMemo(function () {\n        var EmptyPlaceholder = function () { return (React.createElement(React.Fragment, null, EmptyStateIndicator && React.createElement(EmptyStateIndicator, { listType: 'message' }))); };\n        var Header = function () {\n            return loadingMore ? (React.createElement(\"div\", { className: 'str-chat__virtual-list__loading' },\n                React.createElement(LoadingIndicator, { size: 20 }))) : (React.createElement(React.Fragment, null));\n        };\n        var virtualMessageClass = (customClasses === null || customClasses === void 0 ? void 0 : customClasses.virtualMessage) || 'str-chat__virtual-list-message-wrapper';\n        // using 'display: inline-block' traps CSS margins of the item elements, preventing incorrect item measurements\n        var Item = function (props) { return React.createElement(\"div\", __assign({}, props, { className: virtualMessageClass })); };\n        var Footer = function () {\n            return TypingIndicator ? React.createElement(TypingIndicator, { avatarSize: 24 }) : React.createElement(React.Fragment, null);\n        };\n        return {\n            EmptyPlaceholder: EmptyPlaceholder,\n            Footer: Footer,\n            Header: Header,\n            Item: Item,\n        };\n    }, [loadingMore]);\n    var atBottomStateChange = function (isAtBottom) {\n        atBottom.current = isAtBottom;\n        if (isAtBottom && newMessagesNotification) {\n            setNewMessagesNotification(false);\n        }\n    };\n    var startReached = function () {\n        if (hasMore && loadMore) {\n            loadMore(messageLimit);\n        }\n    };\n    var endReached = function () {\n        if (hasMoreNewer && loadMoreNewer) {\n            loadMoreNewer(messageLimit);\n        }\n    };\n    useEffect(function () {\n        var _a;\n        if (highlightedMessageId) {\n            var index = findMessageIndex(processedMessages, highlightedMessageId);\n            if (index !== -1) {\n                (_a = virtuoso.current) === null || _a === void 0 ? void 0 : _a.scrollToIndex({ align: 'center', index: index });\n            }\n        }\n    }, [highlightedMessageId]);\n    if (!processedMessages)\n        return null;\n    return (React.createElement(React.Fragment, null,\n        React.createElement(\"div\", { className: (customClasses === null || customClasses === void 0 ? void 0 : customClasses.virtualizedMessageList) || 'str-chat__virtual-list' },\n            React.createElement(Virtuoso, __assign({ atBottomStateChange: atBottomStateChange, components: virtuosoComponents, endReached: endReached, firstItemIndex: PREPEND_OFFSET - numItemsPrepended, followOutput: followOutput, increaseViewportBy: { bottom: 200, top: 0 }, initialTopMostItemIndex: calculateInitialTopMostItemIndex(processedMessages, highlightedMessageId), itemContent: function (i) { return messageRenderer(processedMessages, i); }, itemSize: fractionalItemSize, key: messageSetKey, overscan: overscan, ref: virtuoso, startReached: startReached, style: { overflowX: 'hidden' }, totalCount: processedMessages.length }, additionalVirtuosoProps, (scrollSeekPlaceHolder ? { scrollSeek: scrollSeekPlaceHolder } : {}), (defaultItemHeight ? { defaultItemHeight: defaultItemHeight } : {})))),\n        React.createElement(MessageListNotifications, { hasNewMessages: newMessagesNotification, isNotAtLatestMessageSet: hasMoreNewer, MessageNotification: MessageNotification, notifications: notifications, scrollToBottom: scrollToBottom }),\n        giphyPreviewMessage && React.createElement(GiphyPreviewMessage, { message: giphyPreviewMessage })));\n};\n/**\n * The VirtualizedMessageList component renders a list of messages in a virtualized list.\n * It is a consumer of the React contexts set in [Channel](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Channel/Channel.tsx).\n *\n * **Note**: It works well when there are thousands of messages in a channel, it has a shortcoming though - the message UI should have a fixed height.\n */\nexport function VirtualizedMessageList(props) {\n    var _a = useChannelActionContext('VirtualizedMessageList'), jumpToLatestMessage = _a.jumpToLatestMessage, loadMore = _a.loadMore, loadMoreNewer = _a.loadMoreNewer;\n    var _b = useChannelStateContext('VirtualizedMessageList'), channel = _b.channel, hasMore = _b.hasMore, hasMoreNewer = _b.hasMoreNewer, highlightedMessageId = _b.highlightedMessageId, loadingMore = _b.loadingMore, loadingMoreNewer = _b.loadingMoreNewer, contextMessages = _b.messages, notifications = _b.notifications, suppressAutoscroll = _b.suppressAutoscroll;\n    var messages = props.messages || contextMessages;\n    return (React.createElement(VirtualizedMessageListWithContext, __assign({ channel: channel, hasMore: !!hasMore, hasMoreNewer: !!hasMoreNewer, highlightedMessageId: highlightedMessageId, jumpToLatestMessage: jumpToLatestMessage, loadingMore: !!loadingMore, loadingMoreNewer: !!loadingMoreNewer, loadMore: loadMore, loadMoreNewer: loadMoreNewer, messages: messages, notifications: notifications, suppressAutoscroll: suppressAutoscroll }, props)));\n}\n"]},"metadata":{},"sourceType":"module"}